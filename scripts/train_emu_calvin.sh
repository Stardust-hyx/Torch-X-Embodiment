deepspeed --include localhost:0,1,2,3,4,5 --master_port 29500 ./src/train.py \
    --data_dir $HYXDIR/calvin/dataset \
    --benchmarks task_ABCD,task_ABCD_rerender \
    --goal_relabeling_strategy last_k_uniform \
    --goal_relabel_offset 8 \
    --goal_relabel_future_step 2 \
    --num_workers 10 \
    --dtype bf16 \
    --emu_ckpt $HYXDIR/huggingface/Emu/pretrain \
    --method emu \
    --prompt_type emu_wo_future \
    --quantization nf4 \
    --double_quant False \
    --gradient_checkpointing True \
    --check_loss_when_eval False \
    --train_batch_size 216 \
    --gradient_accumulation_steps 3 \
    --eval_batch_size 64 \
    --text_loss_weight 0.1 \
    --img_loss_weight 2 \
    --cfg False \
    --max_lr 8e-5 \
    --min_lr 1e-6 \
    --weight_decay 0.01 \
    --max_grad_norm 10 \
    --steps 20000 \
    --warmup_steps 8000 \
    --warmup_type linear \
    --log_interval 1000 \
    --eval_interval 500 \
    --save_interval 500 \
    --start_save 18000 \
    --save_dir $HYXDIR/save_emu/emu_wo_pretrain \
    --random_seed 42