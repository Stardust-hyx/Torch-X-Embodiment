deepspeed --include localhost:0,1,2,3,4,5,6 ./src/train.py \
    --data_dir $HYXDIR/np_datasets \
    --sample_weights balance \
    --goal_relabeling_strategy last_k_uniform \
    --goal_relabel_offset 8 \
    --goal_relabel_future_step 4 \
    --num_workers 4 \
    --dtype bf16 \
    --emu_ckpt $HYXDIR/huggingface/Emu/pretrain \
    --method emu \
    --prompt_type emu_wo_future \
    --quantization nf4 \
    --double_quant False \
    --gradient_checkpointing True \
    --check_loss_when_eval False \
    --train_batch_size 280 \
    --gradient_accumulation_steps 8 \
    --eval_batch_size 48 \
    --text_loss_weight 0.1 \
    --img_loss_weight 2 \
    --cfg False \
    --max_lr 8e-5 \
    --min_lr 2e-6 \
    --weight_decay 0.01 \
    --max_grad_norm 5 \
    --steps 64000 \
    --warmup_steps 10000 \
    --warmup_type linear \
    --log_interval 2000 \
    --eval_interval 10000 \
    --save_interval 10000 \
    --start_save 30000 \
    --save_dir $HYXDIR/save_emu/pretrain \
    --random_seed 41